# Поиск по изображениям

## Описание проекта

Этот проект направлен на создание модели для поиска изображений по текстовым запросам. Основная задача — оценка соответствия текста и изображения с учетом юридических ограничений: изображения с детьми должны быть исключены из результатов поиска.

## Данные

- `train_dataset.csv` — информация для обучения (имя файла изображения, идентификатор описания, текст описания)
- `train_images/` — изображения для обучения модели
- `CrowdAnnotations.tsv` — данные краудсорсинга по соответствию текста и изображений
- `ExpertAnnotations.tsv` — экспертные оценки соответствия изображений и текстов
- `test_queries.csv` — информация для тестирования (идентификатор запроса, текст запроса, релевантное изображение)
- `test_images/` — изображения для тестирования модели

## Этапы выполнения проекта

### 1. Исследовательский анализ данных
- Загрузка и проверка данных
- Анализ часто встречающихся слов в описаниях
- Анализ оценок соответствия изображений текстам (краудсорсинг, эксперты)
- Создание целевого признака (вероятность соответствия текста и изображения)

### 2. Подготовка данных
- Формирование списка запрещенных слов для юридических ограничений
- Очистка данных от изображений с детьми
- Векторизация изображений (ResNet50)
- Векторизация текста (TF-IDF)
- Объединение данных в общий датафрейм

### 3. Обучение модели
- Базовая модель (DummyRegressor, MAE = 0.14)
- Линейная регрессия (Ridge, MAE = 0.13)
- Случайный лес (RandomForestRegressor, MAE = 0.12)
- Полносвязная нейронная сеть (MAE = 0.08) — лучшая модель на данном этапе

### 4. Тестирование модели и демонстрация работы
- Создание функции поиска изображения по текстовому описанию
- Вывод изображения с максимальным соответствием по метрике
- Реализация обработки юридически запрещенных запросов (вывод дисклеймера)

### 5. Улучшение модели
- Использование предобученной модели ViT для поиска изображений
- Улучшение точности и качества предсказаний

## Выводы
- ViT справляется лучше с простыми запросами (конкретные объекты, действия)
- Сложные запросы с контекстом вызывают затруднения (нерелевантные изображения могут получать высокую вероятность)
- Модель часто не уверена в своих предсказаниях и присваивает схожие вероятности разным изображениям

## Рекомендации по улучшению
- Добавление в датасет более сложных текстовых описаний
- Дополнительное обучение модели на более сложных контекстных примерах

## Технологии
- Python
- PyTorch/Keras
- ResNet50, ViT
- TF-IDF
- Jupyter Notebook
